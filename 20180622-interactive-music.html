<html>
<head>
<style>
body {
	font-size: 20px;
	text-align: center;
	font-weight: bold;
	margin: 0;
}

</style>
<!-- <script src="node_modules/tone/build/Tone.js"></script> -->
<script src="https://unpkg.com/tone@0.12.80/build/Tone.js"></script>
<script src="//cdn.jsdelivr.net/npm/phaser@3.9.0/dist/phaser.js"></script>
<script src="node_modules/dat.gui/build/dat.gui.min.js"></script>
<script src="reinforcejs/lib/rl.js"></script>
<script src="ragdoll.js"></script>
<script>
var config = {
	type: Phaser.AUTO,
	width: 800,
	height: 600,
	backgroundColor: '#000000',
	parent: 'phaser-example',
	physics: {
		default: 'matter',
		matter: {
			gravity: {
				y: 0.8
			},
			debug: true,
			debugBodyColor: 0xffffff
		}
	},
	scene: {
		create: create
	}
}

var game = new Phaser.Game(config);

function create () {
	this.matter.world.setBounds();

	this.matter.add.mouseSpring();

	var group = this.matter.world.nextGroup(true);

	var bridge = this.matter.add.stack(160, 490, 15, 1, 0, 0, function(x, y) {
		return Phaser.Physics.Matter.Matter.Bodies.rectangle(x - 20, y, 53, 20, {
			collisionFilter: { group: group },
			chamfer: 5,
			density: 0.005,
			frictionAir: 0.05
		});
	});

	this.matter.add.chain(bridge, 0.3, 0, -0.3, 0, {
		stiffness: 1,
		length: 0,
		render: {
			visible: false
		}
	});

	var stack = this.matter.add.stack(250, 50, 6, 3, 0, 0, function(x, y) {
		return Phaser.Physics.Matter.Matter.Bodies.rectangle(x, y, 50, 50, Phaser.Math.Between(20, 40));
	});

	this.matter.add.rectangle(30, 690, 220, 380, {
		isStatic: true,
		chamfer: { radius: 20 }
	}),

	this.matter.add.rectangle(770, 690, 220, 380, {
		isStatic: true,
		chamfer: { radius: 20 }
	}),

	this.matter.add.worldConstraint(bridge.bodies[0], 2, 0.9, {
		pointA: { x: 140, y: 510 },
		pointB: { x: -25, y: 0 }
	});

	this.matter.add.worldConstraint(bridge.bodies[bridge.bodies.length - 1], 2, 0.9, {
		pointA: { x: 660, y: 510 },
		pointB: { x: 25, y: 0 }
	});

	ragdoll(250, 50, 1, {}, this.matter);
}

</script>
</head>

<body>
	<div class="bad">0 bad</div>
	<div class="good">0 good</div>
	<div class="percent">0.00%</div>
</body>
</html>
